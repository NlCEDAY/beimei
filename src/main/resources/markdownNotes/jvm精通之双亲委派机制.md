## 双亲委派机制：

>java虚拟机对class文件采用的是**按需加载**的方式，也就是说，当需要使用该类时才会将它的class文件加载到内存生成class对象，而且加载某个类的class文件时，java虚拟机采用的是**双亲委派模式，即请求由父类处理**，它是一种任务委派模式。



### 双亲委派工作原理：

1. 如果一个类加载器收到了类加载请求，它并**不会自己先去加载**，而是把这个**请求委托给父类加载器**去执行
2. 如果父类加载器**还存在其父类加载器，则进一步向上委托**，依次递归，请求**最终将到达顶层的启动类加载器**
3. 如果**父类加载器可以完成类加载任务，就成功返回，倘若父类加载器无法完成此加载任务，子加载器才会尝试自己去加载**，这就是双亲委派模式



![image-20200715162943450](C:%5CUsers%5Clenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20200715162943450.png)



### 双亲委派的优点：

- 避免类的重复加载
- 保护程序安全，防止核心API被随意篡改---沙箱安全机制

### 类的主动与被动使用方式：

`主动使用`

- 创建类的实例
- 访问某个类或接口的静态变量，或者对该静态变量赋值
- 调用类的静态方法
- 反射（Class.forname("com.wy.")）
- 初始化一个类的子类
- java虚拟机启动时被标明为启动类的类
- jdk1.7之后提供动态语言支持：
  - REF_getStatic,REF_putStatic,REF_invokeStatic句柄对应的类没有初始化，则初始化。

`被动使用`

- 除了以上七种情况，其余使用java类的方式都是类得被动使用，不会导致类的初始化。